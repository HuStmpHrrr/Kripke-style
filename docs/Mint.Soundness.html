<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Mint.Soundness</title><link rel="stylesheet" href="Agda.css"><script type="text/javascript" src="highlight-hover.js"></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--without-K</a> <a id="25" class="Pragma">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>

<a id="85" class="Comment">-- Proof of the soundness theorem</a>
<a id="119" class="Comment">--</a>
<a id="122" class="Comment">-- If a term is well-typed, then it is equivalent to its βη normal form.</a>
<a id="195" class="Keyword">module</a> <a id="202" href="Mint.Soundness.html" class="Module">Mint.Soundness</a> <a id="217" class="Symbol">(</a><a id="218" href="Mint.Soundness.html#218" class="Bound">fext</a> <a id="223" class="Symbol">:</a> <a id="225" class="Symbol">∀</a> <a id="227" class="Symbol">{</a><a id="228" href="Mint.Soundness.html#228" class="Bound">ℓ</a> <a id="230" href="Mint.Soundness.html#230" class="Bound">ℓ′</a><a id="232" class="Symbol">}</a> <a id="234" class="Symbol">→</a> <a id="236" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="251" href="Mint.Soundness.html#228" class="Bound">ℓ</a> <a id="253" href="Mint.Soundness.html#230" class="Bound">ℓ′</a><a id="255" class="Symbol">)</a> <a id="257" class="Keyword">where</a>

<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Lib.html" class="Module">Lib</a>

<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="Mint.Statics.Properties.html" class="Module">Mint.Statics.Properties</a>
<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Mint.Semantics.Readback.html" class="Module">Mint.Semantics.Readback</a>
<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="Mint.Semantics.Properties.Domain.html" class="Module">Mint.Semantics.Properties.Domain</a> <a id="398" href="Mint.Soundness.html#218" class="Bound">fext</a>
<a id="403" class="Keyword">open</a> <a id="408" class="Keyword">import</a> <a id="415" href="Mint.Semantics.Properties.PER.html" class="Module">Mint.Semantics.Properties.PER</a> <a id="445" href="Mint.Soundness.html#218" class="Bound">fext</a>
<a id="450" class="Keyword">open</a> <a id="455" class="Keyword">import</a> <a id="462" href="Mint.Completeness.Fundamental.html" class="Module">Mint.Completeness.Fundamental</a> <a id="492" href="Mint.Soundness.html#218" class="Bound">fext</a>
<a id="497" class="Keyword">open</a> <a id="502" class="Keyword">import</a> <a id="509" href="Mint.Soundness.LogRel.html" class="Module">Mint.Soundness.LogRel</a>
<a id="531" class="Keyword">open</a> <a id="536" class="Keyword">import</a> <a id="543" href="Mint.Soundness.Properties.Substitutions.html" class="Module">Mint.Soundness.Properties.Substitutions</a> <a id="583" href="Mint.Soundness.html#218" class="Bound">fext</a>
<a id="588" class="Keyword">open</a> <a id="593" class="Keyword">import</a> <a id="600" href="Mint.Soundness.Realizability.html" class="Module">Mint.Soundness.Realizability</a> <a id="629" href="Mint.Soundness.html#218" class="Bound">fext</a>
<a id="634" class="Keyword">open</a> <a id="639" class="Keyword">import</a> <a id="646" href="Mint.Soundness.Fundamental.html" class="Module">Mint.Soundness.Fundamental</a> <a id="673" href="Mint.Soundness.html#218" class="Bound">fext</a>


<a id="soundness"></a><a id="680" href="Mint.Soundness.html#680" class="Function">soundness</a> <a id="690" class="Symbol">:</a> <a id="692" href="Mint.Statics.Syntax.html#3656" class="Generalizable">Γ</a> <a id="694" href="Mint.Statics.Concise.html#1142" class="Datatype Operator">⊢</a> <a id="696" href="Mint.Statics.Syntax.html#3690" class="Generalizable">t</a> <a id="698" href="Mint.Statics.Concise.html#1142" class="Datatype Operator">∶</a> <a id="700" href="Mint.Statics.Syntax.html#3603" class="Generalizable">T</a> <a id="702" class="Symbol">→</a>
            <a id="716" href="Data.Product.html#1369" class="Function">∃</a> <a id="718" class="Symbol">λ</a> <a id="720" href="Mint.Soundness.html#720" class="Bound">w</a> <a id="722" class="Symbol">→</a> <a id="724" href="Mint.Semantics.Readback.html#6152" class="Record">NbE</a> <a id="728" href="Mint.Statics.Syntax.html#3656" class="Generalizable">Γ</a> <a id="730" href="Mint.Statics.Syntax.html#3690" class="Generalizable">t</a> <a id="732" href="Mint.Statics.Syntax.html#3603" class="Generalizable">T</a> <a id="734" href="Mint.Soundness.html#720" class="Bound">w</a> <a id="736" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="738" href="Mint.Statics.Syntax.html#3656" class="Generalizable">Γ</a> <a id="740" href="Mint.Statics.Concise.html#3941" class="Datatype Operator">⊢</a> <a id="742" href="Mint.Statics.Syntax.html#3690" class="Generalizable">t</a> <a id="744" href="Mint.Statics.Concise.html#3941" class="Datatype Operator">≈</a> <a id="746" href="Mint.Statics.Syntax.html#4101" class="Function">Nf⇒Exp</a> <a id="753" href="Mint.Soundness.html#720" class="Bound">w</a> <a id="755" href="Mint.Statics.Concise.html#3941" class="Datatype Operator">∶</a> <a id="757" href="Mint.Statics.Syntax.html#3603" class="Generalizable">T</a>
<a id="759" href="Mint.Soundness.html#680" class="Function">soundness</a> <a id="769" class="Symbol">{</a><a id="770" href="Mint.Soundness.html#770" class="Bound">Γ</a><a id="771" class="Symbol">}</a> <a id="773" class="Symbol">{</a><a id="774" href="Mint.Soundness.html#774" class="Bound">t</a><a id="775" class="Symbol">}</a> <a id="777" class="Symbol">{</a><a id="778" href="Mint.Soundness.html#778" class="Bound">T</a><a id="779" class="Symbol">}</a> <a id="781" href="Mint.Soundness.html#781" class="Bound">⊢t</a>
  <a id="786" class="Keyword">with</a> <a id="791" class="Keyword">record</a> <a id="798" class="Symbol">{</a> <a id="800" href="Mint.Soundness.LogRel.html#15396" class="Field">⊩Γ</a> <a id="803" class="Symbol">=</a> <a id="805" href="Mint.Soundness.html#805" class="Bound">⊩Γ</a> <a id="808" class="Symbol">;</a> <a id="810" href="Mint.Soundness.LogRel.html#15527" class="Field">krip</a> <a id="815" class="Symbol">=</a> <a id="817" href="Mint.Soundness.html#817" class="Bound">krip</a> <a id="822" class="Symbol">}</a> ← <a id="826" href="Mint.Soundness.Fundamental.html#3210" class="Function">fundamental-⊢t⇒⊩t</a> <a id="844" href="Mint.Soundness.html#781" class="Bound">⊢t</a>
    <a id="851" class="Keyword">with</a> <a id="856" href="Mint.Soundness.html#856" class="Bound">ρ</a> <a id="858" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="860" class="Symbol">_</a> <a id="862" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="864" href="Mint.Soundness.html#864" class="Bound">ρinit</a> <a id="870" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="872" class="Symbol">_</a> ← <a id="876" href="Mint.Semantics.Properties.PER.html#32004" class="Function">InitEnvs-related</a> <a id="893" class="Symbol">(</a><a id="894" href="Mint.Completeness.Fundamental.html#850" class="Function">fundamental-⊢Γ</a> <a id="909" class="Symbol">(</a><a id="910" href="Mint.Soundness.LogRel.html#14711" class="Function">⊩⇒⊢</a> <a id="914" href="Mint.Soundness.html#805" class="Bound">⊩Γ</a><a id="916" class="Symbol">))</a>
     <a id="924" class="Keyword">with</a> <a id="929" class="Keyword">record</a> <a id="936" class="Symbol">{</a> <a id="938" href="Mint.Soundness.LogRel.html#14961" class="Field">⟦T⟧</a> <a id="942" class="Symbol">=</a> <a id="944" href="Mint.Soundness.html#944" class="Bound">⟦T⟧</a> <a id="948" class="Symbol">;</a> <a id="950" href="Mint.Soundness.LogRel.html#14975" class="Field">⟦t⟧</a> <a id="954" class="Symbol">=</a> <a id="956" href="Mint.Soundness.html#956" class="Bound">⟦t⟧</a> <a id="960" class="Symbol">;</a> <a id="962" href="Mint.Soundness.LogRel.html#14989" class="Field">↘⟦T⟧</a> <a id="967" class="Symbol">=</a> <a id="969" href="Mint.Soundness.html#969" class="Bound">↘⟦T⟧</a> <a id="974" class="Symbol">;</a> <a id="976" href="Mint.Soundness.LogRel.html#15015" class="Field">↘⟦t⟧</a> <a id="981" class="Symbol">=</a> <a id="983" href="Mint.Soundness.html#983" class="Bound">↘⟦t⟧</a> <a id="988" class="Symbol">;</a> <a id="990" href="Mint.Soundness.LogRel.html#15041" class="Field">T∈𝕌</a> <a id="994" class="Symbol">=</a> <a id="996" href="Mint.Soundness.html#996" class="Bound">T∈𝕌</a> <a id="1000" class="Symbol">;</a> <a id="1002" href="Mint.Soundness.LogRel.html#15064" class="Field">t∼⟦t⟧</a> <a id="1008" class="Symbol">=</a> <a id="1010" href="Mint.Soundness.html#1010" class="Bound">t∼⟦t⟧</a> <a id="1016" class="Symbol">}</a> ← <a id="1020" href="Mint.Soundness.html#817" class="Bound">krip</a> <a id="1025" class="Symbol">(</a><a id="1026" href="Mint.Soundness.Properties.Substitutions.html#14746" class="Function">InitEnvs⇒s®I</a> <a id="1039" href="Mint.Soundness.html#805" class="Bound">⊩Γ</a> <a id="1042" href="Mint.Soundness.html#864" class="Bound">ρinit</a><a id="1047" class="Symbol">)</a>
        <a id="1057" class="Keyword">with</a> <a id="1062" class="Keyword">record</a> <a id="1069" class="Symbol">{</a> <a id="1071" href="Mint.Soundness.LogRel.html#10841" class="Field">a∈⊤</a> <a id="1075" class="Symbol">=</a> <a id="1077" href="Mint.Soundness.html#1077" class="Bound">a∈⊤</a> <a id="1081" class="Symbol">;</a> <a id="1083" href="Mint.Soundness.LogRel.html#10872" class="Field">krip</a> <a id="1088" class="Symbol">=</a> <a id="1090" href="Mint.Soundness.html#1090" class="Bound">krip</a> <a id="1095" class="Symbol">}</a> ← <a id="1099" href="Mint.Soundness.Realizability.html#26841" class="Function">®El⇒®↑El</a> <a id="1108" href="Mint.Soundness.html#996" class="Bound">T∈𝕌</a> <a id="1112" href="Mint.Soundness.html#1010" class="Bound">t∼⟦t⟧</a>
           <a id="1129" class="Keyword">with</a> <a id="1134" href="Mint.Soundness.html#1134" class="Bound">w</a> <a id="1136" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1138" href="Mint.Soundness.html#1138" class="Bound">↘w</a> <a id="1141" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1143" class="Symbol">_</a> ← <a id="1147" href="Mint.Soundness.html#1077" class="Bound">a∈⊤</a> <a id="1151" class="Symbol">(</a><a id="1152" href="Data.List.NonEmpty.Base.html#2053" class="Function">map</a> <a id="1156" href="LibNonEmpty.html#717" class="Field">len</a> <a id="1160" href="Mint.Soundness.html#770" class="Bound">Γ</a><a id="1161" class="Symbol">)</a> <a id="1163" href="Mint.Semantics.Domain.html#6344" class="Function">vone</a>
              <a id="1182" class="Symbol">|</a> <a id="1184" href="Mint.Soundness.html#1184" class="Bound">eq</a> ← <a id="1189" href="Mint.Soundness.html#1090" class="Bound">krip</a> <a id="1194" class="Symbol">(</a><a id="1195" href="Mint.Soundness.Restricted.html#7390" class="Function">⊢rI</a> <a id="1199" class="Symbol">(</a><a id="1200" href="Mint.Soundness.LogRel.html#14711" class="Function">⊩⇒⊢</a> <a id="1204" href="Mint.Soundness.html#805" class="Bound">⊩Γ</a><a id="1206" class="Symbol">))</a>
             <a id="1222" class="Keyword">rewrite</a> <a id="1230" href="Mint.Semantics.Properties.Domain.html#6009" class="Function">D-ap-vone</a> <a id="1240" href="Mint.Soundness.html#956" class="Bound">⟦t⟧</a>
                   <a id="1263" class="Symbol">|</a> <a id="1265" href="Mint.Semantics.Properties.Domain.html#6009" class="Function">D-ap-vone</a> <a id="1275" href="Mint.Soundness.html#944" class="Bound">⟦T⟧</a> <a id="1279" class="Symbol">=</a> <a id="1281" href="Mint.Soundness.html#1134" class="Bound">w</a> <a id="1283" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1285" href="Mint.Soundness.html#1318" class="Function">nbe</a> <a id="1289" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1291" href="Mint.Statics.Properties.html#11216" class="Function">[I]-≈ˡ</a> <a id="1298" class="Symbol">(</a><a id="1299" href="Mint.Statics.Properties.html#11216" class="Function">[I]-≈ˡ</a> <a id="1306" href="Mint.Soundness.html#1184" class="Bound">eq</a><a id="1308" class="Symbol">)</a>
  <a id="1312" class="Keyword">where</a> <a id="1318" href="Mint.Soundness.html#1318" class="Function">nbe</a> <a id="1322" class="Symbol">:</a> <a id="1324" href="Mint.Semantics.Readback.html#6152" class="Record">NbE</a> <a id="1328" href="Mint.Soundness.html#770" class="Bound">Γ</a> <a id="1330" href="Mint.Soundness.html#774" class="Bound">t</a> <a id="1332" href="Mint.Soundness.html#778" class="Bound">T</a> <a id="1334" href="Mint.Soundness.html#1134" class="Bound">w</a>
        <a id="1344" href="Mint.Soundness.html#1318" class="Function">nbe</a> <a id="1348" class="Symbol">=</a> <a id="1350" class="Keyword">record</a>
          <a id="1367" class="Symbol">{</a> <a id="1369" href="Mint.Semantics.Readback.html#6188" class="Field">envs</a> <a id="1374" class="Symbol">=</a> <a id="1376" href="Mint.Soundness.html#856" class="Bound">ρ</a>
          <a id="1388" class="Symbol">;</a> <a id="1390" href="Mint.Semantics.Readback.html#6204" class="Field">init</a> <a id="1395" class="Symbol">=</a> <a id="1397" href="Mint.Soundness.html#864" class="Bound">ρinit</a>
          <a id="1413" class="Symbol">;</a> <a id="1415" href="Mint.Semantics.Readback.html#6231" class="Field">nbe</a>  <a id="1420" class="Symbol">=</a> <a id="1422" class="Keyword">record</a>
            <a id="1441" class="Symbol">{</a> <a id="1443" href="Mint.Semantics.Readback.html#5506" class="Field">⟦t⟧</a>  <a id="1448" class="Symbol">=</a> <a id="1450" href="Mint.Soundness.html#956" class="Bound">⟦t⟧</a>
            <a id="1466" class="Symbol">;</a> <a id="1468" href="Mint.Semantics.Readback.html#5519" class="Field">⟦T⟧</a>  <a id="1473" class="Symbol">=</a> <a id="1475" href="Mint.Soundness.html#944" class="Bound">⟦T⟧</a>
            <a id="1491" class="Symbol">;</a> <a id="1493" href="Mint.Semantics.Readback.html#5532" class="Field">↘⟦t⟧</a> <a id="1498" class="Symbol">=</a> <a id="1500" href="Mint.Soundness.html#983" class="Bound">↘⟦t⟧</a>
            <a id="1517" class="Symbol">;</a> <a id="1519" href="Mint.Semantics.Readback.html#5557" class="Field">↘⟦T⟧</a> <a id="1524" class="Symbol">=</a> <a id="1526" href="Mint.Soundness.html#969" class="Bound">↘⟦T⟧</a>
            <a id="1543" class="Symbol">;</a> <a id="1545" href="Mint.Semantics.Readback.html#5582" class="Field">↓⟦t⟧</a> <a id="1550" class="Symbol">=</a> <a id="1552" href="Mint.Soundness.html#1138" class="Bound">↘w</a>
            <a id="1567" class="Symbol">}</a>
          <a id="1579" class="Symbol">}</a>
</pre></body></html>