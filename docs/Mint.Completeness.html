<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Mint.Completeness</title><link rel="stylesheet" href="Agda.css"><script type="text/javascript" src="highlight-hover.js"></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--without-K</a> <a id="25" class="Pragma">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>

<a id="85" class="Comment">-- Proof of the completeness theorem</a>
<a id="122" class="Comment">--</a>
<a id="125" class="Comment">-- If two terms are equivalent, then they have equal βη normal form.</a>
<a id="194" class="Keyword">module</a> <a id="201" href="Mint.Completeness.html" class="Module">Mint.Completeness</a> <a id="219" class="Symbol">(</a><a id="220" href="Mint.Completeness.html#220" class="Bound">fext</a> <a id="225" class="Symbol">:</a> <a id="227" class="Symbol">∀</a> <a id="229" class="Symbol">{</a><a id="230" href="Mint.Completeness.html#230" class="Bound">ℓ</a> <a id="232" href="Mint.Completeness.html#232" class="Bound">ℓ′</a><a id="234" class="Symbol">}</a> <a id="236" class="Symbol">→</a> <a id="238" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="253" href="Mint.Completeness.html#230" class="Bound">ℓ</a> <a id="255" href="Mint.Completeness.html#232" class="Bound">ℓ′</a><a id="257" class="Symbol">)</a> <a id="259" class="Keyword">where</a>

<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Lib.html" class="Module">Lib</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Mint.Completeness.Fundamental.html" class="Module">Mint.Completeness.Fundamental</a> <a id="324" href="Mint.Completeness.html#220" class="Bound">fext</a>
<a id="329" class="Keyword">open</a> <a id="334" class="Keyword">import</a> <a id="341" href="Mint.Semantics.Domain.html" class="Module">Mint.Semantics.Domain</a>
<a id="363" class="Keyword">open</a> <a id="368" class="Keyword">import</a> <a id="375" href="Mint.Semantics.Evaluation.html" class="Module">Mint.Semantics.Evaluation</a>
<a id="401" class="Keyword">open</a> <a id="406" class="Keyword">import</a> <a id="413" href="Mint.Semantics.Properties.Domain.html" class="Module">Mint.Semantics.Properties.Domain</a> <a id="446" href="Mint.Completeness.html#220" class="Bound">fext</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Mint.Semantics.Properties.Evaluation.html" class="Module">Mint.Semantics.Properties.Evaluation</a> <a id="500" href="Mint.Completeness.html#220" class="Bound">fext</a>
<a id="505" class="Keyword">open</a> <a id="510" class="Keyword">import</a> <a id="517" href="Mint.Semantics.Properties.PER.html" class="Module">Mint.Semantics.Properties.PER</a> <a id="547" href="Mint.Completeness.html#220" class="Bound">fext</a>
<a id="552" class="Keyword">open</a> <a id="557" class="Keyword">import</a> <a id="564" href="Mint.Semantics.Readback.html" class="Module">Mint.Semantics.Readback</a>
<a id="588" class="Keyword">open</a> <a id="593" class="Keyword">import</a> <a id="600" href="Mint.Semantics.Realizability.html" class="Module">Mint.Semantics.Realizability</a> <a id="629" href="Mint.Completeness.html#220" class="Bound">fext</a>
<a id="634" class="Keyword">open</a> <a id="639" class="Keyword">import</a> <a id="646" href="Mint.Statics.html" class="Module">Mint.Statics</a>

<a id="completeness"></a><a id="660" href="Mint.Completeness.html#660" class="Function">completeness</a> <a id="673" class="Symbol">:</a> <a id="675" href="Mint.Statics.Syntax.html#3656" class="Generalizable">Γ</a> <a id="677" href="Mint.Statics.Concise.html#3941" class="Datatype Operator">⊢</a> <a id="679" href="Mint.Statics.Syntax.html#3690" class="Generalizable">t</a> <a id="681" href="Mint.Statics.Concise.html#3941" class="Datatype Operator">≈</a> <a id="683" href="Mint.Statics.Syntax.html#3692" class="Generalizable">t′</a> <a id="686" href="Mint.Statics.Concise.html#3941" class="Datatype Operator">∶</a> <a id="688" href="Mint.Statics.Syntax.html#3603" class="Generalizable">T</a> <a id="690" class="Symbol">→</a>
               <a id="707" href="Data.Product.html#1369" class="Function">∃</a> <a id="709" class="Symbol">λ</a> <a id="711" href="Mint.Completeness.html#711" class="Bound">w</a> <a id="713" class="Symbol">→</a> <a id="715" href="Mint.Semantics.Readback.html#6152" class="Record">NbE</a> <a id="719" href="Mint.Statics.Syntax.html#3656" class="Generalizable">Γ</a> <a id="721" href="Mint.Statics.Syntax.html#3690" class="Generalizable">t</a> <a id="723" href="Mint.Statics.Syntax.html#3603" class="Generalizable">T</a> <a id="725" href="Mint.Completeness.html#711" class="Bound">w</a> <a id="727" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="729" href="Mint.Semantics.Readback.html#6152" class="Record">NbE</a> <a id="733" href="Mint.Statics.Syntax.html#3656" class="Generalizable">Γ</a> <a id="735" href="Mint.Statics.Syntax.html#3692" class="Generalizable">t′</a> <a id="738" href="Mint.Statics.Syntax.html#3603" class="Generalizable">T</a> <a id="740" href="Mint.Completeness.html#711" class="Bound">w</a>
<a id="742" href="Mint.Completeness.html#660" class="Function">completeness</a> <a id="755" class="Symbol">{</a><a id="756" href="Mint.Completeness.html#756" class="Bound">Γ</a><a id="757" class="Symbol">}</a> <a id="759" href="Mint.Completeness.html#759" class="Bound">t≈t′</a>
  <a id="766" class="Keyword">with</a> <a id="771" href="Mint.Completeness.html#771" class="Bound">⊨Γ</a> <a id="774" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="776" class="Symbol">_</a> <a id="778" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="780" href="Mint.Completeness.html#780" class="Bound">t≈t′</a> ← <a id="787" href="Mint.Completeness.Fundamental.html#3138" class="Function">fundamental-t≈t′</a> <a id="804" href="Mint.Completeness.html#759" class="Bound">t≈t′</a>
    <a id="813" class="Keyword">with</a> <a id="818" class="Symbol">_</a> <a id="820" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="822" class="Symbol">_</a> <a id="824" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="826" href="Mint.Completeness.html#826" class="Bound">↘ρ</a> <a id="829" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="831" href="Mint.Completeness.html#831" class="Bound">↘ρ′</a> <a id="835" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="837" href="Mint.Completeness.html#837" class="Bound">ρ≈ρ′</a> ← <a id="844" href="Mint.Semantics.Properties.PER.html#32004" class="Function">InitEnvs-related</a> <a id="861" href="Mint.Completeness.html#771" class="Bound">⊨Γ</a>
      <a id="870" class="Keyword">with</a> <a id="875" href="Mint.Completeness.html#780" class="Bound">t≈t′</a> <a id="880" href="Mint.Completeness.html#837" class="Bound">ρ≈ρ′</a>
<a id="885" class="Symbol">...</a>      <a id="894" class="Symbol">|</a> <a id="896" class="Keyword">record</a> <a id="903" class="Symbol">{</a> <a id="905" href="Mint.Semantics.PER.html#5287" class="Field">⟦T⟧</a> <a id="909" class="Symbol">=</a> <a id="911" href="Mint.Completeness.html#911" class="Bound">⟦T⟧</a> <a id="915" class="Symbol">;</a> <a id="917" href="Mint.Semantics.PER.html#5301" class="Field">⟦T′⟧</a> <a id="922" class="Symbol">=</a> <a id="924" href="Mint.Completeness.html#924" class="Bound">⟦T′⟧</a> <a id="929" class="Symbol">;</a> <a id="931" href="Mint.Semantics.PER.html#5315" class="Field">↘⟦T⟧</a> <a id="936" class="Symbol">=</a> <a id="938" href="Mint.Completeness.html#938" class="Bound">↘⟦T⟧</a> <a id="943" class="Symbol">;</a> <a id="945" href="Mint.Semantics.PER.html#5341" class="Field">↘⟦T′⟧</a> <a id="951" class="Symbol">=</a> <a id="953" href="Mint.Completeness.html#953" class="Bound">↘⟦T′⟧</a> <a id="959" class="Symbol">;</a> <a id="961" href="Mint.Semantics.PER.html#5370" class="Field">T≈T′</a> <a id="966" class="Symbol">=</a> <a id="968" href="Mint.Completeness.html#968" class="Bound">T≈T′</a> <a id="973" class="Symbol">}</a>
         <a id="984" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="986" class="Keyword">record</a> <a id="993" class="Symbol">{</a> <a id="995" href="Mint.Completeness.LogRel.html#329" class="Field">⟦t⟧</a> <a id="999" class="Symbol">=</a> <a id="1001" href="Mint.Completeness.html#1001" class="Bound">⟦t⟧</a> <a id="1005" class="Symbol">;</a> <a id="1007" href="Mint.Completeness.LogRel.html#343" class="Field">⟦t′⟧</a> <a id="1012" class="Symbol">=</a> <a id="1014" href="Mint.Completeness.html#1014" class="Bound">⟦t′⟧</a> <a id="1019" class="Symbol">;</a> <a id="1021" href="Mint.Completeness.LogRel.html#357" class="Field">↘⟦t⟧</a> <a id="1026" class="Symbol">=</a> <a id="1028" href="Mint.Completeness.html#1028" class="Bound">↘⟦t⟧</a> <a id="1033" class="Symbol">;</a> <a id="1035" href="Mint.Completeness.LogRel.html#383" class="Field">↘⟦t′⟧</a> <a id="1041" class="Symbol">=</a> <a id="1043" href="Mint.Completeness.html#1043" class="Bound">↘⟦t′⟧</a> <a id="1049" class="Symbol">;</a> <a id="1051" href="Mint.Completeness.LogRel.html#412" class="Field">t≈t′</a> <a id="1056" class="Symbol">=</a> <a id="1058" href="Mint.Completeness.html#1058" class="Bound">t≈t′</a> <a id="1063" class="Symbol">}</a>
         <a id="1074" class="Keyword">with</a> <a id="1079" class="Symbol">_</a> <a id="1081" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1083" href="Mint.Completeness.html#1083" class="Bound">↓⟦t⟧</a> <a id="1088" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1090" href="Mint.Completeness.html#1090" class="Bound">↓⟦t′⟧</a> ← <a id="1098" href="Mint.Semantics.Realizability.html#7326" class="Function">realizability-Rf</a> <a id="1115" href="Mint.Completeness.html#968" class="Bound">T≈T′</a> <a id="1120" href="Mint.Completeness.html#1058" class="Bound">t≈t′</a> <a id="1125" class="Symbol">(</a><a id="1126" href="Data.List.NonEmpty.Base.html#2053" class="Function">map</a> <a id="1130" href="LibNonEmpty.html#717" class="Field">len</a> <a id="1134" class="Bound">Γ</a><a id="1135" class="Symbol">)</a> <a id="1137" href="Mint.Semantics.Domain.html#6344" class="Function">vone</a>
           <a id="1153" class="Keyword">rewrite</a> <a id="1161" href="Mint.Semantics.Properties.Domain.html#6851" class="Function">Df-ap-vone</a> <a id="1172" class="Symbol">(</a><a id="1173" href="Mint.Semantics.Domain.html#2683" class="InductiveConstructor">↓</a> <a id="1175" href="Mint.Completeness.html#911" class="Bound">⟦T⟧</a> <a id="1179" href="Mint.Completeness.html#1001" class="Bound">⟦t⟧</a><a id="1182" class="Symbol">)</a>
                 <a id="1201" class="Symbol">|</a> <a id="1203" href="Mint.Semantics.Properties.Domain.html#6851" class="Function">Df-ap-vone</a> <a id="1214" class="Symbol">(</a><a id="1215" href="Mint.Semantics.Domain.html#2683" class="InductiveConstructor">↓</a> <a id="1217" href="Mint.Completeness.html#924" class="Bound">⟦T′⟧</a> <a id="1222" href="Mint.Completeness.html#1014" class="Bound">⟦t′⟧</a><a id="1226" class="Symbol">)</a> <a id="1228" class="Symbol">=</a> <a id="1230" class="Symbol">_</a>
                                           <a id="1275" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1277" class="Keyword">record</a>
                                             <a id="1329" class="Symbol">{</a> <a id="1331" href="Mint.Semantics.Readback.html#6204" class="Field">init</a> <a id="1336" class="Symbol">=</a> <a id="1338" href="Mint.Completeness.html#826" class="Bound">↘ρ</a>
                                             <a id="1386" class="Symbol">;</a> <a id="1388" href="Mint.Semantics.Readback.html#6231" class="Field">nbe</a> <a id="1392" class="Symbol">=</a> <a id="1394" class="Keyword">record</a>
                                                     <a id="1454" class="Symbol">{</a> <a id="1456" href="Mint.Semantics.Readback.html#5532" class="Field">↘⟦t⟧</a> <a id="1461" class="Symbol">=</a> <a id="1463" href="Mint.Completeness.html#1028" class="Bound">↘⟦t⟧</a>
                                                     <a id="1521" class="Symbol">;</a> <a id="1523" href="Mint.Semantics.Readback.html#5557" class="Field">↘⟦T⟧</a> <a id="1528" class="Symbol">=</a> <a id="1530" href="Mint.Completeness.html#938" class="Bound">↘⟦T⟧</a>
                                                     <a id="1588" class="Symbol">;</a> <a id="1590" href="Mint.Semantics.Readback.html#5582" class="Field">↓⟦t⟧</a> <a id="1595" class="Symbol">=</a> <a id="1597" href="Mint.Completeness.html#1083" class="Bound">↓⟦t⟧</a>
                                                     <a id="1655" class="Symbol">}</a>
                                             <a id="1702" class="Symbol">}</a>
                                           <a id="1747" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1749" class="Keyword">record</a>
                                             <a id="1801" class="Symbol">{</a> <a id="1803" href="Mint.Semantics.Readback.html#6204" class="Field">init</a> <a id="1808" class="Symbol">=</a> <a id="1810" href="Mint.Completeness.html#831" class="Bound">↘ρ′</a>
                                             <a id="1859" class="Symbol">;</a> <a id="1861" href="Mint.Semantics.Readback.html#6231" class="Field">nbe</a> <a id="1865" class="Symbol">=</a> <a id="1867" class="Keyword">record</a>
                                                     <a id="1927" class="Symbol">{</a> <a id="1929" href="Mint.Semantics.Readback.html#5532" class="Field">↘⟦t⟧</a> <a id="1934" class="Symbol">=</a> <a id="1936" href="Mint.Completeness.html#1043" class="Bound">↘⟦t′⟧</a>
                                                     <a id="1995" class="Symbol">;</a> <a id="1997" href="Mint.Semantics.Readback.html#5557" class="Field">↘⟦T⟧</a> <a id="2002" class="Symbol">=</a> <a id="2004" href="Mint.Completeness.html#953" class="Bound">↘⟦T′⟧</a>
                                                     <a id="2063" class="Symbol">;</a> <a id="2065" href="Mint.Semantics.Readback.html#5582" class="Field">↓⟦t⟧</a> <a id="2070" class="Symbol">=</a> <a id="2072" href="Mint.Completeness.html#1090" class="Bound">↓⟦t′⟧</a>
                                                     <a id="2131" class="Symbol">}</a>
                                             <a id="2178" class="Symbol">}</a>
</pre></body></html>