<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MAlonzo.RTE.Float</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bifunctor</span><span>   </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">bimap</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">second</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Function</span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">on</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>       </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Ratio</span><span>       </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">%</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">numerator</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">denominator</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Word</span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Word64</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 804
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Float</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castDoubleToWord64</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">castWord64ToDouble</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-cpp">#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.IO.Unsafe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsafePerformIO</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Foreign</span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Foreign.Storable</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F</span><span>
</span><a name="line-17"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-19"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 804
</span><span class="hs-identifier">castDoubleToWord64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word64</span><span>
</span><a name="line-21"></a><span class="hs-identifier">castDoubleToWord64</span><span> </span><span class="hs-identifier">float</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafePerformIO</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">F.alloca</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">buf</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-22"></a><span>  </span><span class="hs-identifier">F.poke</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">F.castPtr</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">float</span><span>
</span><a name="line-23"></a><span>  </span><span class="hs-identifier">F.peek</span><span> </span><span class="hs-identifier">buf</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-identifier">castWord64ToDouble</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Double</span><span>
</span><a name="line-26"></a><span class="hs-identifier">castWord64ToDouble</span><span> </span><span class="hs-identifier">word</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafePerformIO</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">F.alloca</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">buf</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-identifier">F.poke</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">F.castPtr</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">word</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-identifier">F.peek</span><span> </span><span class="hs-identifier">buf</span><span>
</span><a name="line-29"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-31"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleEq</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-32"></a><span class="hs-identifier">doubleEq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-33"></a><a name="doubleEq"><a href="MAlonzo.RTE.Float.html#doubleEq"><span class="hs-identifier">doubleEq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleLe</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-36"></a><span class="hs-identifier">doubleLe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-37"></a><a name="doubleLe"><a href="MAlonzo.RTE.Float.html#doubleLe"><span class="hs-identifier">doubleLe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;=</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleLt</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-40"></a><span class="hs-identifier">doubleLt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-41"></a><a name="doubleLt"><a href="MAlonzo.RTE.Float.html#doubleLt"><span class="hs-identifier">doubleLt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-identifier">truncateDouble</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-44"></a><a name="truncateDouble"><a href="MAlonzo.RTE.Float.html#truncateDouble"><span class="hs-identifier">truncateDouble</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">castWord64ToDouble</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">castDoubleToWord64</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">intToDouble</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-47"></a><span class="hs-identifier">intToDouble</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621680550070"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621680550070"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-48"></a><a name="intToDouble"><a href="MAlonzo.RTE.Float.html#intToDouble"><span class="hs-identifier">intToDouble</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MAlonzo.RTE.Float.html#truncateDouble"><span class="hs-identifier hs-var">truncateDouble</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doublePlus</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-51"></a><span class="hs-identifier">doublePlus</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-52"></a><a name="doublePlus"><a href="MAlonzo.RTE.Float.html#doublePlus"><span class="hs-identifier">doublePlus</span></a></a><span> </span><a name="local-6989586621680550071"><a href="#local-6989586621680550071"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680550072"><a href="#local-6989586621680550072"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MAlonzo.RTE.Float.html#truncateDouble"><span class="hs-identifier hs-var">truncateDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680550071"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621680550072"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleMinus</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-55"></a><span class="hs-identifier">doubleMinus</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-56"></a><a name="doubleMinus"><a href="MAlonzo.RTE.Float.html#doubleMinus"><span class="hs-identifier">doubleMinus</span></a></a><span> </span><a name="local-6989586621680550073"><a href="#local-6989586621680550073"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680550074"><a href="#local-6989586621680550074"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MAlonzo.RTE.Float.html#truncateDouble"><span class="hs-identifier hs-var">truncateDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680550073"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621680550074"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleTimes</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-59"></a><span class="hs-identifier">doubleTimes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-60"></a><a name="doubleTimes"><a href="MAlonzo.RTE.Float.html#doubleTimes"><span class="hs-identifier">doubleTimes</span></a></a><span> </span><a name="local-6989586621680550075"><a href="#local-6989586621680550075"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680550076"><a href="#local-6989586621680550076"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MAlonzo.RTE.Float.html#truncateDouble"><span class="hs-identifier hs-var">truncateDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680550075"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621680550076"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleNegate</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-63"></a><span class="hs-identifier">doubleNegate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-64"></a><a name="doubleNegate"><a href="MAlonzo.RTE.Float.html#doubleNegate"><span class="hs-identifier">doubleNegate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">negate</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleDiv</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-67"></a><span class="hs-identifier">doubleDiv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-68"></a><a name="doubleDiv"><a href="MAlonzo.RTE.Float.html#doubleDiv"><span class="hs-identifier">doubleDiv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doublePow</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-71"></a><span class="hs-identifier">doublePow</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-72"></a><a name="doublePow"><a href="MAlonzo.RTE.Float.html#doublePow"><span class="hs-identifier">doublePow</span></a></a><span> </span><a name="local-6989586621680550077"><a href="#local-6989586621680550077"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680550078"><a href="#local-6989586621680550078"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MAlonzo.RTE.Float.html#truncateDouble"><span class="hs-identifier hs-var">truncateDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680550077"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">**</span><span> </span><a href="#local-6989586621680550078"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleSqrt</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-75"></a><span class="hs-identifier">doubleSqrt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-76"></a><a name="doubleSqrt"><a href="MAlonzo.RTE.Float.html#doubleSqrt"><span class="hs-identifier">doubleSqrt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleExp</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-79"></a><span class="hs-identifier">doubleExp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-80"></a><a name="doubleExp"><a href="MAlonzo.RTE.Float.html#doubleExp"><span class="hs-identifier">doubleExp</span></a></a><span> </span><a name="local-6989586621680550079"><a href="#local-6989586621680550079"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MAlonzo.RTE.Float.html#truncateDouble"><span class="hs-identifier hs-var">truncateDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exp</span><span> </span><a href="#local-6989586621680550079"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleLog</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-83"></a><span class="hs-identifier">doubleLog</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-84"></a><a name="doubleLog"><a href="MAlonzo.RTE.Float.html#doubleLog"><span class="hs-identifier">doubleLog</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">log</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleSin</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-87"></a><span class="hs-identifier">doubleSin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-88"></a><a name="doubleSin"><a href="MAlonzo.RTE.Float.html#doubleSin"><span class="hs-identifier">doubleSin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sin</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleCos</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-91"></a><span class="hs-identifier">doubleCos</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-92"></a><a name="doubleCos"><a href="MAlonzo.RTE.Float.html#doubleCos"><span class="hs-identifier">doubleCos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cos</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleTan</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-95"></a><span class="hs-identifier">doubleTan</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-96"></a><a name="doubleTan"><a href="MAlonzo.RTE.Float.html#doubleTan"><span class="hs-identifier">doubleTan</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tan</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleASin</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-99"></a><span class="hs-identifier">doubleASin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-100"></a><a name="doubleASin"><a href="MAlonzo.RTE.Float.html#doubleASin"><span class="hs-identifier">doubleASin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">asin</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleACos</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-103"></a><span class="hs-identifier">doubleACos</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-104"></a><a name="doubleACos"><a href="MAlonzo.RTE.Float.html#doubleACos"><span class="hs-identifier">doubleACos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">acos</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleATan</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-107"></a><span class="hs-identifier">doubleATan</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-108"></a><a name="doubleATan"><a href="MAlonzo.RTE.Float.html#doubleATan"><span class="hs-identifier">doubleATan</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">atan</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleATan2</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-111"></a><span class="hs-identifier">doubleATan2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-112"></a><a name="doubleATan2"><a href="MAlonzo.RTE.Float.html#doubleATan2"><span class="hs-identifier">doubleATan2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">atan2</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleSinh</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-115"></a><span class="hs-identifier">doubleSinh</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-116"></a><a name="doubleSinh"><a href="MAlonzo.RTE.Float.html#doubleSinh"><span class="hs-identifier">doubleSinh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sinh</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleCosh</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-119"></a><span class="hs-identifier">doubleCosh</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-120"></a><a name="doubleCosh"><a href="MAlonzo.RTE.Float.html#doubleCosh"><span class="hs-identifier">doubleCosh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cosh</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleTanh</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-123"></a><span class="hs-identifier">doubleTanh</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-124"></a><a name="doubleTanh"><a href="MAlonzo.RTE.Float.html#doubleTanh"><span class="hs-identifier">doubleTanh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tanh</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleASinh</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-127"></a><span class="hs-identifier">doubleASinh</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-128"></a><a name="doubleASinh"><a href="MAlonzo.RTE.Float.html#doubleASinh"><span class="hs-identifier">doubleASinh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">asinh</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleACosh</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-131"></a><span class="hs-identifier">doubleACosh</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-132"></a><a name="doubleACosh"><a href="MAlonzo.RTE.Float.html#doubleACosh"><span class="hs-identifier">doubleACosh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">acosh</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">doubleATanh</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-135"></a><span class="hs-identifier">doubleATanh</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-136"></a><a name="doubleATanh"><a href="MAlonzo.RTE.Float.html#doubleATanh"><span class="hs-identifier">doubleATanh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">atanh</span><span> </span><span class="hs-comment">-- NOTE: doesn't cause underflow/overflow</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">negativeZero</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-139"></a><span class="hs-identifier">negativeZero</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-140"></a><a name="negativeZero"><a href="MAlonzo.RTE.Float.html#negativeZero"><span class="hs-identifier">negativeZero</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">0.0</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-identifier">positiveInfinity</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-143"></a><a name="positiveInfinity"><a href="MAlonzo.RTE.Float.html#positiveInfinity"><span class="hs-identifier">positiveInfinity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-identifier">negativeInfinity</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-146"></a><a name="negativeInfinity"><a href="MAlonzo.RTE.Float.html#negativeInfinity"><span class="hs-identifier">negativeInfinity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><a href="MAlonzo.RTE.Float.html#positiveInfinity"><span class="hs-identifier hs-var">positiveInfinity</span></a><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-identifier">nan</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-149"></a><a name="nan"><a href="MAlonzo.RTE.Float.html#nan"><span class="hs-identifier">nan</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-identifier">isPosInf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-152"></a><a name="isPosInf"><a href="MAlonzo.RTE.Float.html#isPosInf"><span class="hs-identifier">isPosInf</span></a></a><span> </span><a name="local-6989586621680550080"><a href="#local-6989586621680550080"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680550080"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isInfinite</span><span> </span><a href="#local-6989586621680550080"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-identifier">isNegInf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-155"></a><a name="isNegInf"><a href="MAlonzo.RTE.Float.html#isNegInf"><span class="hs-identifier">isNegInf</span></a></a><span> </span><a name="local-6989586621680550081"><a href="#local-6989586621680550081"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680550081"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isInfinite</span><span> </span><a href="#local-6989586621680550081"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-identifier">isPosZero</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-158"></a><a name="isPosZero"><a href="MAlonzo.RTE.Float.html#isPosZero"><span class="hs-identifier">isPosZero</span></a></a><span> </span><a name="local-6989586621680550082"><a href="#local-6989586621680550082"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MAlonzo.RTE.Float.html#doubleDenotEq"><span class="hs-identifier hs-var">doubleDenotEq</span></a><span> </span><a href="#local-6989586621680550082"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-identifier">isNegZero</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-161"></a><a name="isNegZero"><a href="MAlonzo.RTE.Float.html#isNegZero"><span class="hs-identifier">isNegZero</span></a></a><span> </span><a name="local-6989586621680550083"><a href="#local-6989586621680550083"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MAlonzo.RTE.Float.html#doubleDenotEq"><span class="hs-identifier hs-var">doubleDenotEq</span></a><span> </span><a href="#local-6989586621680550083"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">0.0</span><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-identifier">doubleRound</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-164"></a><a name="doubleRound"><a href="MAlonzo.RTE.Float.html#doubleRound"><span class="hs-identifier">doubleRound</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">round</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="MAlonzo.RTE.Float.html#asFinite"><span class="hs-identifier hs-var">asFinite</span></a><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-identifier">doubleFloor</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-167"></a><a name="doubleFloor"><a href="MAlonzo.RTE.Float.html#doubleFloor"><span class="hs-identifier">doubleFloor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">floor</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="MAlonzo.RTE.Float.html#asFinite"><span class="hs-identifier hs-var">asFinite</span></a><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-identifier">doubleCeiling</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-170"></a><a name="doubleCeiling"><a href="MAlonzo.RTE.Float.html#doubleCeiling"><span class="hs-identifier">doubleCeiling</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">ceiling</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="MAlonzo.RTE.Float.html#asFinite"><span class="hs-identifier hs-var">asFinite</span></a><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-identifier">normaliseNaN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-173"></a><a name="normaliseNaN"><a href="MAlonzo.RTE.Float.html#normaliseNaN"><span class="hs-identifier">normaliseNaN</span></a></a><span> </span><a name="local-6989586621680550084"><a href="#local-6989586621680550084"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-174"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isNaN</span><span> </span><a href="#local-6989586621680550084"><span class="hs-identifier hs-var">x</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="MAlonzo.RTE.Float.html#nan"><span class="hs-identifier hs-var">nan</span></a><span>
</span><a name="line-175"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680550084"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-identifier">doubleToWord64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-178"></a><a name="doubleToWord64"><a href="MAlonzo.RTE.Float.html#doubleToWord64"><span class="hs-identifier">doubleToWord64</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">castDoubleToWord64</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="MAlonzo.RTE.Float.html#normaliseNaN"><span class="hs-identifier hs-var">normaliseNaN</span></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">-- |Denotational equality for floating point numbers, checks bitwise equality.</span><span>
</span><a name="line-181"></a><span class="hs-comment">--</span><span>
</span><a name="line-182"></a><span class="hs-comment">--  NOTE: Denotational equality distinguishes NaNs, so its results may vary</span><span>
</span><a name="line-183"></a><span class="hs-comment">--        depending on the architecture and compilation flags. Unfortunately,</span><span>
</span><a name="line-184"></a><span class="hs-comment">--        this is a problem with floating-point numbers in general.</span><span>
</span><a name="line-185"></a><span class="hs-comment">--</span><span>
</span><a name="line-186"></a><span class="hs-identifier">doubleDenotEq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-187"></a><a name="doubleDenotEq"><a href="MAlonzo.RTE.Float.html#doubleDenotEq"><span class="hs-identifier">doubleDenotEq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="MAlonzo.RTE.Float.html#doubleToWord64"><span class="hs-identifier hs-var">doubleToWord64</span></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">-- |I guess &quot;denotational orderings&quot; are now a thing? The point is that we need</span><span>
</span><a name="line-190"></a><span class="hs-comment">--  an Ord instance which provides a total ordering, and is consistent with the</span><span>
</span><a name="line-191"></a><span class="hs-comment">--  denotational equality.</span><span>
</span><a name="line-192"></a><span class="hs-comment">--</span><span>
</span><a name="line-193"></a><span class="hs-comment">--  NOTE: The ordering induced via `doubleToWord64` is total, and is consistent</span><span>
</span><a name="line-194"></a><span class="hs-comment">--        with `doubleDenotEq`. However, it is *deeply* unintuitive. For one, it</span><span>
</span><a name="line-195"></a><span class="hs-comment">--        considers all negative numbers to be larger than positive numbers.</span><span>
</span><a name="line-196"></a><span class="hs-comment">--</span><span>
</span><a name="line-197"></a><span class="hs-identifier">doubleDenotOrd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-198"></a><a name="doubleDenotOrd"><a href="MAlonzo.RTE.Float.html#doubleDenotOrd"><span class="hs-identifier">doubleDenotOrd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="MAlonzo.RTE.Float.html#doubleToWord64"><span class="hs-identifier hs-var">doubleToWord64</span></a><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-comment">-- |Return Just x if it's a finite number, otherwise return Nothing.</span><span>
</span><a name="line-201"></a><span class="hs-identifier">asFinite</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-202"></a><a name="asFinite"><a href="MAlonzo.RTE.Float.html#asFinite"><span class="hs-identifier">asFinite</span></a></a><span> </span><a name="local-6989586621680550085"><a href="#local-6989586621680550085"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-203"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isNaN</span><span>      </span><a href="#local-6989586621680550085"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-204"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isInfinite</span><span> </span><a href="#local-6989586621680550085"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-205"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621680550085"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">-- |Decode a Double to an integer ratio.</span><span>
</span><a name="line-208"></a><span class="hs-identifier">doubleToRatio</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span>
</span><a name="line-209"></a><a name="doubleToRatio"><a href="MAlonzo.RTE.Float.html#doubleToRatio"><span class="hs-identifier">doubleToRatio</span></a></a><span> </span><a name="local-6989586621680550086"><a href="#local-6989586621680550086"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-210"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isNaN</span><span>      </span><a href="#local-6989586621680550086"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-211"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isInfinite</span><span> </span><a href="#local-6989586621680550086"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">signum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">floor</span><span> </span><a href="#local-6989586621680550086"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680550087"><a href="#local-6989586621680550087"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toRational</span><span> </span><a href="#local-6989586621680550086"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">numerator</span><span> </span><a href="#local-6989586621680550087"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">denominator</span><span> </span><a href="#local-6989586621680550087"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">-- |Encode an integer ratio as a double.</span><span>
</span><a name="line-215"></a><span class="hs-identifier">ratioToDouble</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-216"></a><a name="ratioToDouble"><a href="MAlonzo.RTE.Float.html#ratioToDouble"><span class="hs-identifier">ratioToDouble</span></a></a><span> </span><a name="local-6989586621680550088"><a href="#local-6989586621680550088"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680550089"><a href="#local-6989586621680550089"><span class="hs-identifier">d</span></a></a><span>
</span><a name="line-217"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680550089"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621680550088"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-218"></a><span>      </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MAlonzo.RTE.Float.html#negativeInfinity"><span class="hs-identifier hs-var">negativeInfinity</span></a><span>
</span><a name="line-219"></a><span>      </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MAlonzo.RTE.Float.html#nan"><span class="hs-identifier hs-var">nan</span></a><span>
</span><a name="line-220"></a><span>      </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MAlonzo.RTE.Float.html#positiveInfinity"><span class="hs-identifier hs-var">positiveInfinity</span></a><span>
</span><a name="line-221"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromRational</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680550088"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">%</span><span> </span><a href="#local-6989586621680550089"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">-- |Decode a Double to its mantissa and its exponent, normalised such that the</span><span>
</span><a name="line-224"></a><span class="hs-comment">--  mantissa is the smallest possible number without loss of accuracy.</span><span>
</span><a name="line-225"></a><span class="hs-identifier">doubleDecode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span>
</span><a name="line-226"></a><a name="doubleDecode"><a href="MAlonzo.RTE.Float.html#doubleDecode"><span class="hs-identifier">doubleDecode</span></a></a><span> </span><a name="local-6989586621680550090"><a href="#local-6989586621680550090"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-227"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isNaN</span><span>      </span><a href="#local-6989586621680550090"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isInfinite</span><span> </span><a href="#local-6989586621680550090"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="#local-6989586621680550091"><span class="hs-identifier hs-var">normalise</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">second</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">decodeFloat</span><span> </span><a href="#local-6989586621680550090"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-231"></a><span>    </span><span class="hs-identifier">normalise</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>    </span><a name="local-6989586621680550091"><a href="#local-6989586621680550091"><span class="hs-identifier">normalise</span></a></a><span> </span><a name="local-6989586621680550092"><a href="#local-6989586621680550092"><span class="hs-identifier">mantissa</span></a></a><span> </span><a name="local-6989586621680550093"><a href="#local-6989586621680550093"><span class="hs-identifier">exponent</span></a></a><span>
</span><a name="line-233"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">even</span><span> </span><a href="#local-6989586621680550092"><span class="hs-identifier hs-var">mantissa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680550091"><span class="hs-identifier hs-var">normalise</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680550092"><span class="hs-identifier hs-var">mantissa</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680550093"><span class="hs-identifier hs-var">exponent</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680550092"><span class="hs-identifier hs-var">mantissa</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680550093"><span class="hs-identifier hs-var">exponent</span></a><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-comment">-- |Checks whether or not the Double is within a safe range of operation.</span><span>
</span><a name="line-237"></a><span class="hs-identifier">isSafeInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-238"></a><a name="isSafeInteger"><a href="MAlonzo.RTE.Float.html#isSafeInteger"><span class="hs-identifier">isSafeInteger</span></a></a><span> </span><a name="local-6989586621680550110"><a href="#local-6989586621680550110"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">properFraction</span><span> </span><a href="#local-6989586621680550110"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621680550111"><a href="#local-6989586621680550111"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680550112"><a href="#local-6989586621680550112"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680550112"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="MAlonzo.RTE.Float.html#minMantissa"><span class="hs-identifier hs-var">minMantissa</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621680550111"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680550111"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="MAlonzo.RTE.Float.html#maxMantissa"><span class="hs-identifier hs-var">maxMantissa</span></a><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-identifier">doubleRadix</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-242"></a><a name="doubleRadix"><a href="MAlonzo.RTE.Float.html#doubleRadix"><span class="hs-identifier">doubleRadix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">floatRadix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-identifier">doubleDigits</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-245"></a><a name="doubleDigits"><a href="MAlonzo.RTE.Float.html#doubleDigits"><span class="hs-identifier">doubleDigits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">floatDigits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-identifier">doubleRange</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-248"></a><a name="doubleRange"><a href="MAlonzo.RTE.Float.html#doubleRange"><span class="hs-identifier">doubleRange</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">floatRange</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-comment">-- |The smallest representable mantissa. Simultaneously, the smallest integer which can be</span><span>
</span><a name="line-251"></a><span class="hs-comment">--  represented as a Double without loss of precision.</span><span>
</span><a name="line-252"></a><span class="hs-identifier">minMantissa</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-253"></a><a name="minMantissa"><a href="MAlonzo.RTE.Float.html#minMantissa"><span class="hs-identifier">minMantissa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="MAlonzo.RTE.Float.html#maxMantissa"><span class="hs-identifier hs-var">maxMantissa</span></a><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-comment">-- |The largest representable mantissa. Simultaneously, the largest integer which can be</span><span>
</span><a name="line-256"></a><span class="hs-comment">--  represented as a Double without loss of precision.</span><span>
</span><a name="line-257"></a><span class="hs-identifier">maxMantissa</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-258"></a><a name="maxMantissa"><a href="MAlonzo.RTE.Float.html#maxMantissa"><span class="hs-identifier">maxMantissa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="MAlonzo.RTE.Float.html#doubleRadix"><span class="hs-identifier hs-var">doubleRadix</span></a><span> </span><span class="hs-operator hs-var">^</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="MAlonzo.RTE.Float.html#doubleDigits"><span class="hs-identifier hs-var">doubleDigits</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-comment">-- |The largest representable exponent.</span><span>
</span><a name="line-261"></a><span class="hs-identifier">minExponent</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-262"></a><a name="minExponent"><a href="MAlonzo.RTE.Float.html#minExponent"><span class="hs-identifier">minExponent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="MAlonzo.RTE.Float.html#doubleRange"><span class="hs-identifier hs-var">doubleRange</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="MAlonzo.RTE.Float.html#doubleDigits"><span class="hs-identifier hs-var">doubleDigits</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">-- |The smallest representable exponent.</span><span>
</span><a name="line-265"></a><span class="hs-identifier">maxExponent</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-266"></a><a name="maxExponent"><a href="MAlonzo.RTE.Float.html#maxExponent"><span class="hs-identifier">maxExponent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="MAlonzo.RTE.Float.html#doubleRange"><span class="hs-identifier hs-var">doubleRange</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="MAlonzo.RTE.Float.html#doubleDigits"><span class="hs-identifier hs-var">doubleDigits</span></a><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-comment">-- |Encode a mantissa and an exponent as a Double.</span><span>
</span><a name="line-269"></a><span class="hs-identifier">doubleEncode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-270"></a><a name="doubleEncode"><a href="MAlonzo.RTE.Float.html#doubleEncode"><span class="hs-identifier">doubleEncode</span></a></a><span> </span><a name="local-6989586621680550113"><a href="#local-6989586621680550113"><span class="hs-identifier">mantissa</span></a></a><span> </span><a name="local-6989586621680550114"><a href="#local-6989586621680550114"><span class="hs-identifier">exponent</span></a></a><span>
</span><a name="line-271"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="MAlonzo.RTE.Float.html#minMantissa"><span class="hs-identifier hs-var">minMantissa</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621680550113"><span class="hs-identifier hs-var">mantissa</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680550113"><span class="hs-identifier hs-var">mantissa</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="MAlonzo.RTE.Float.html#maxMantissa"><span class="hs-identifier hs-var">maxMantissa</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-272"></a><span>       </span><a href="MAlonzo.RTE.Float.html#minExponent"><span class="hs-identifier hs-var">minExponent</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621680550114"><span class="hs-identifier hs-var">exponent</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680550114"><span class="hs-identifier hs-var">exponent</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="MAlonzo.RTE.Float.html#maxExponent"><span class="hs-identifier hs-var">maxExponent</span></a><span>
</span><a name="line-273"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">encodeFloat</span><span> </span><a href="#local-6989586621680550113"><span class="hs-identifier hs-var">mantissa</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680550114"><span class="hs-identifier hs-var">exponent</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-275"></a></pre></body></html>